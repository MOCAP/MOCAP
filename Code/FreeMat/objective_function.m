function [f] = objective_function (q, d, s)
    
    f_1 = 2*d(2)*(0.5 - q(3)^2 - q(4)^2) + 2*d(3)*(q(1)*q(4) + q(2)*q(3)) + 2*d(4)*(q(2)*q(4) - q(1)*q(3)) - s(2); 
    f_2 = 2*d(2)*(q(2)*q(3) - q(1)*q(4))   + 2*d(3)*(0.5 - q(2)^2 - q(4)^2)   + 2*d(4)*(q(1)*q(2) + q(3)*q(4))   - s(3);
    f_3 = 2*d(2)*(q(1)*q(3) + q(2)*q(4))   + 2*d(3)*(q(3)*q(4) - q(1)*q(2))   + 2*d(4)*(0.5 - q(2)^2 - q(3)^2)   - s(4);
    f = [f_1; f_2; f_3];
    